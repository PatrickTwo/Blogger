// 接口的特性及用法
// 最后更新时间：2025年12月9日11:18:08

#### 一、接口的两大学派
- **古典学派**：认为接口只能提供公共方法签名，如 Java 早期和 C# 早期的做法。
- **现代学派**：现代接口包含各种元素，如属性、索引器、事件、默认实现方法、静态方法等。

#### 二、接口特性详情

##### （一）基本规则
- 可以声明方法签名，但不能给出实现，也不能添加访问修饰符（如 private、protected 等）。

##### （二）属性、索引器和事件
- **普通类**：属性和事件是语法糖，编译器会在后台生成对应的字段。自动属性会在后台生成字段，分别通过 get 和 set 操作该字段；自动事件会生成委托并包装成事件，通过 ADD 和 remove 操作背后的委托。
- **接口**：属性、事件和索引器只是约束其 get、set、ADD、remove 方法的访问权限以及它们的存在性，背后没有对应的字段。索引器不能写自动索引器，需要显式给出 get 和 set（可只给一个）。

##### （三）接口方法的显示实现
- **产生原因**：当一个类实现多个接口，且这些接口包含同名方法时，使用显式实现（如 `void 接口名.方法名`）来解决调用冲突，明确指定实现的是哪个接口的方法。
- **常见应用场景**
    - 传参时更关注功能而非对象类型，例如使用 `IEnumerable<int>` 作为参数，可接收 `array` 或 `list` 等不同类型的集合，避免不必要的数据转换。
    - 刻意**隐藏**接口的某些功能，如 `ReadOnlyDictionary` 使用显式实现隐藏 `IDictionary` 接口上的 `Add`、`Remove` 等修改集合的方法，将这些方法抛出 `NotSupportedException`。
> 显式实现使得该成员只能通过**接口类型**访问，不能通过类实例直接访问

##### （四）接口中方法的默认实现
- **引入版本**：C# 8.0
- **特点**：接口可以为方法提供默认实现（使用 `Console.WriteLine` 等输出示例），实现该接口的类不需要给出相关方法的实现，但也可以重写。
- **调用规则**
    - 若类重写了接口的默认实现方法，可直接通过类对象调用重写后的方法。
    - 若调用接口的默认实现方法，必须将对象转换为接口类型后调用。
    - 若类重写方法覆盖了接口默认实现，通过类对象只能调用重写后的方法，无法调用接口的默认实现。

##### （五）接口中的非公共成员
- **引入版本**：C# 8.0
- **private 成员**
    - **规则**：可以声明 private 方法，但必须给出实现，因为 private 方法是为了辅助 public 方法的实现，若没有实现则无意义。
    - **特殊情况**：在分部接口中，分布的 private 方法可以不提供实现；private extern 方法也可以不提供实现。
- **protected 成员**：类似于 private，但除了辅助自身方法实现，还可辅助子接口的方法实现，仅限于接口和子接口之间，与子类无关。

##### （六）接口中的静态方法
- **引入版本**：C# 8.0
- **规则**：可以声明静态方法，且必须有默认实现。静态方法只能从接口类型上调用，局限性较大，因为调用时不知道具体子类及其成员。
- **应用场景**：常与泛型接口结合使用，例如定义泛型接口 `IDeserializable<T>`，其中包含静态方法 `Deserialize`，用于将 JSON 字符串反序列化为指定类型 `T` 的对象。

##### （七）抽象静态方法
- **引入版本**：C# 10.0
- **规则**：可以只给出方法签名，不给出实现。实现该接口的类必须提供该方法的具体实现，可用于约束子类必须提供某些静态方法。
- **应用场景**
    - **反序列化**：约束子类提供反序列化方法。
    - **工厂模式**：约束工厂类提供静态的 `Create` 方法。
    - **单例模式**：约束实现接口的类提供静态的 `Instance` 属性，用于获取单例对象。
    - **运算符**：约束类实现相应的运算符逻辑，如加减运算符。

##### （八）静态虚拟方法（Static Virtual Method）
- **引入版本**：C# 11（在 `INumberBase` 接口中出现，微软无官方文档介绍）
- **规则**：可以声明带有默认实现的静态虚拟方法（使用 `static virtual` 关键字），子类可以实现也可以不实现该方法。在类中可以通过类对象调用实现后的方法，在接口中无法调用该方法。
- **推测作用**：类似于弱化的 `abstract static`，为子类提供实现建议，不强制要求，可在方法中编写文档注释。

#### 三、总结
- 不要死记硬背接口特性，要理解其设计目的、原理和用法。
- 接口不仅为解决 C# 多继承问题（以及结构体不能继承其他结构体只能实现接口），更重要的是为开发过程带来便利。
- 项目开发初期不必急于抽取所有接口和方法，可在需要时进行调整。后续将分享实际项目实战中接口的使用考虑和场合。
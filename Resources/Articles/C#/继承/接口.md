### **C# 接口（Interface）详解**  

在 C# 中，**接口（Interface）** 是一种**完全抽象的类**，它只包含方法、属性、事件或索引器的**声明**，而不包含实现。接口定义了一组**契约（Contract）**，任何实现该接口的类都必须提供这些成员的具体实现。  

---

## **1. 接口的基本语法**
```csharp
public interface IExampleInterface
{
    // 方法声明（无实现）
    void DoSomething();

    // 属性声明（无实现）
    int Value { get; set; }

    // 事件声明（无实现）
    event EventHandler OnEvent;

    // 索引器声明（无实现）
    string this[int index] { get; set; }
}
```

### **实现接口的类**
```csharp
public class ExampleClass : IExampleInterface
{
    // 必须实现接口的所有成员
    public void DoSomething()
    {
        Console.WriteLine("Doing something...");
    }

    public int Value { get; set; }

    public event EventHandler OnEvent;

    public string this[int index]
    {
        get { return "Value"; }
        set { /* 设置值 */ }
    }
}
```

---

## **2. 接口的特点**
1. **不能包含字段**（只能包含方法、属性、事件、索引器）。
2. **不能有构造函数**（因为接口不能被实例化）。
3. **默认所有成员都是 `public`**（不能使用 `private`、`protected` 等修饰符）。
4. **支持多继承**（一个类可以实现多个接口）。
5. **从 C# 8.0 开始，接口可以包含默认实现**（`default` 关键字）。

---

## **3. 接口的作用**
### **(1) 实现多态（Polymorphism）**
```csharp
public interface IShape
{
    double CalculateArea();
}

public class Circle : IShape
{
    public double Radius { get; set; }
    public double CalculateArea() => Math.PI * Radius * Radius;
}

public class Rectangle : IShape
{
    public double Width { get; set; }
    public double Height { get; set; }
    public double CalculateArea() => Width * Height;
}

// 使用接口类型调用方法
IShape shape1 = new Circle { Radius = 5 };
IShape shape2 = new Rectangle { Width = 4, Height = 6 };

Console.WriteLine(shape1.CalculateArea()); // 78.5398...
Console.WriteLine(shape2.CalculateArea()); // 24
```

### **(2) 实现多重继承（C# 不支持类的多继承，但支持接口多继承）**
```csharp
public interface ILogger
{
    void Log(string message);
}

public interface IDatabase
{
    void SaveData(string data);
}

public class DataManager : ILogger, IDatabase
{
    public void Log(string message) => Console.WriteLine($"Log: {message}");
    public void SaveData(string data) => Console.WriteLine($"Saved: {data}");
}
```

### **(3) 依赖注入（Dependency Injection）**
```csharp
public interface IMessageService
{
    void SendMessage(string message);
}

public class EmailService : IMessageService
{
    public void SendMessage(string message) => Console.WriteLine($"Email: {message}");
}

public class SmsService : IMessageService
{
    public void SendMessage(string message) => Console.WriteLine($"SMS: {message}");
}

// 通过接口注入不同的实现
public class NotificationService
{
    private readonly IMessageService _messageService;

    public NotificationService(IMessageService messageService)
    {
        _messageService = messageService;
    }

    public void Notify(string message)
    {
        _messageService.SendMessage(message);
    }
}

// 使用
var emailNotifier = new NotificationService(new EmailService());
emailNotifier.Notify("Hello via Email!");

var smsNotifier = new NotificationService(new SmsService());
smsNotifier.Notify("Hello via SMS!");
```

---

## **4. 显式接口实现（Explicit Interface Implementation）**
当多个接口有同名方法时，可以使用**显式实现**来避免冲突：
```csharp
public interface IWriter
{
    void Write();
}

public interface ILogger
{
    void Write();
}

public class FileLogger : IWriter, ILogger
{
    // 显式实现 IWriter.Write
    void IWriter.Write() => Console.WriteLine("Writing to file...");

    // 显式实现 ILogger.Write
    void ILogger.Write() => Console.WriteLine("Logging message...");
}

// 调用方式
var logger = new FileLogger();

((IWriter)logger).Write(); // "Writing to file..."
((ILogger)logger).Write(); // "Logging message..."
```

---

## **5. C# 8.0+ 接口的默认实现**
从 C# 8.0 开始，接口可以包含**默认实现**（`default` 关键字）：
```csharp
public interface ILogger
{
    // 默认实现
    void Log(string message) => Console.WriteLine($"Default log: {message}");

    // 必须由实现类提供的方法
    void LogError(string error);
}

public class ConsoleLogger : ILogger
{
    // 只需要实现 LogError，Log 已经有默认实现
    public void LogError(string error) => Console.WriteLine($"Error: {error}");
}

// 使用
ILogger logger = new ConsoleLogger();
logger.Log("Hello");      // 使用默认实现
logger.LogError("Oops!"); // 使用自定义实现
```

---

## **6. 接口 vs 抽象类**
| **特性**          | **接口（Interface）** | **抽象类（Abstract Class）** |
|------------------|----------------------|----------------------------|
| **能否实例化**    | ❌ 不能              | ❌ 不能                    |
| **能否包含实现**  | ✅（C# 8.0+）       | ✅                        |
| **能否包含字段**  | ❌                   | ✅                        |
| **能否有构造函数**| ❌                   | ✅                        |
| **继承方式**      | 支持多继承           | 单继承                     |
| **适用场景**      | 定义契约、多态       | 提供部分实现、共享代码     |

---

## **7. 总结**
- **接口** 是一种**契约**，定义了一组必须实现的方法、属性等。
- **类可以实现多个接口**，但只能继承一个类（单继承）。
- **接口支持多态**，使代码更灵活、可扩展。
- **C# 8.0+ 允许接口提供默认实现**，减少重复代码。
- **显式接口实现**可以解决命名冲突问题。

接口是 C# 中非常重要的概念，广泛应用于 **依赖注入（DI）、设计模式（如策略模式、工厂模式）、插件架构** 等场景。
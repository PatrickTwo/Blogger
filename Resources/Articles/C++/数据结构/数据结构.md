
## 一、集合（set）
在C++中，主要的集合类有 `set`、`multiset`、`unordered_set`、`unordered_multiset`。以下是它们的常用操作：

#### 基本声明

```cpp
#include <set>           // set, multiset
#include <unordered_set> // unordered_set, unordered_multiset
#include <iostream>
using namespace std;

// 基本声明
set<int> s1;                    // 有序，不允许重复
multiset<int> ms1;              // 有序，允许重复
unordered_set<int> us1;         // 无序，不允许重复
unordered_multiset<int> ums1;   // 无序，允许重复
```

### 1. 插入操作
`insert` 方法用于向集合中插入元素。

```cpp
// 插入单个元素
set.insert(30);
// 插入多个元素（C++11）
et.insert({40, 50, 60});
```

### 2. 删除操作
``
:::warning
当调用`erase()`方法时，需要注意以下几点：
- 如果删除的元素不存在，`erase()`方法不会报错，只是返回0。
- 如果删除的元素存在多个副本，`erase()`方法会删除所有匹配的元素。
- 删除元素后，集合的迭代器会失效，不会自动将迭代器设置为 end() 或其他有效值。
:::

```cpp
set<int> s = {10, 20, 30, 40, 50};

// 按值删除
s.erase(30);  // 删除值为30的元素

// 按迭代器删除
auto it = s.find(20);
if (it != s.end()) {
    s.erase(it);  // 删除迭代器指向的元素
}

// 删除一段区间
auto start = s.find(10);
auto end = s.find(40);
if (start != s.end() && end != s.end()) {
    s.erase(start, end);  // 删除[10, 40)区间的元素
}

// 清空集合
s.clear();

// 获取大小
cout << "集合大小: " << s.size() << endl;
cout << "是否为空: " << (s.empty() ? "是" : "否") << endl;

```

### 4. 查找操作
:::hint
对于`multiset`集合，通过`find`方法只能找到第一个匹配的元素的迭代器。如果需要找到所有匹配的元素，需要使用`equal_range`方法。
:::

```cpp
#include <set>
#include <unordered_set>
#include <iostream>
using namespace std;

int main() {
    set<int> s = {10, 20, 30, 40, 50};
    unordered_set<int> us = {10, 20, 30, 40, 50};
    
    // 使用 find() - 所有集合都支持
    auto it_s = s.find(30);
    if (it_s != s.end()) {
        cout << "set中找到: " << *it_s << endl;
    } else {
        cout << "set中未找到" << endl;
    }
    
    auto it_us = us.find(30);
    if (it_us != us.end()) {
        cout << "unordered_set中找到: " << *it_us << endl;
    }
    
    // 使用 count() - 返回元素出现的次数
    cout << "set中10的个数: " << s.count(10) << endl;    // 1
    cout << "set中100的个数: " << s.count(100) << endl;  // 0
    
    // multiset/multiset 特有：lower_bound, upper_bound, equal_range
    multiset<int> ms = {10, 20, 20, 30, 30, 30, 40};
    
    auto lb = ms.lower_bound(25);  // 第一个 >= 25 的元素
    auto ub = ms.upper_bound(30);  // 第一个 > 30 的元素
    
    cout << "lower_bound(25): " << *lb << endl;  // 30
    cout << "upper_bound(30): " << *ub << endl;  // 40
    
    return 0;
}
```

### 5. 遍历操作

```cpp
#include <set>
#include <unordered_set>
#include <iostream>
using namespace std;

int main() {
    set<int> s = {30, 10, 20, 40, 50};  // 自动排序
    
    // 方法1：范围for循环
    cout << "范围for循环: ";
    for (int num : s) {
        cout << num << " ";
    }
    cout << endl;
    
    // 方法2：迭代器
    cout << "正向迭代器: ";
    for (auto it = s.begin(); it != s.end(); ++it) {
        cout << *it << " ";
    }
    cout << endl;
    
    // 方法3：反向迭代器
    cout << "反向迭代器: ";
    for (auto it = s.rbegin(); it != s.rend(); ++it) {
        cout << *it << " ";
    }
    cout << endl;
    
    // 方法4：while循环
    cout << "while循环: ";
    auto it = s.begin();
    while (it != s.end()) {
        cout << *it << " ";
        ++it;
    }
    cout << endl;
    
    return 0;
}
```

### 6. 自定义排序和比较器

```cpp
#include <set>
#include <iostream>
using namespace std;

// 自定义结构体
struct Person {
    string name;
    int age;
    
    Person(string n, int a) : name(n), age(a) {}
    
    // 重载 < 运算符（set需要）
    bool operator<(const Person& other) const {
        return age < other.age;  // 按年龄排序
    }
};

// 自定义比较器类
struct ComparePerson {
    bool operator()(const Person& p1, const Person& p2) const {
        return p1.name < p2.name;  // 按姓名排序
    }
};

int main() {
    // 使用默认排序（按age）
    set<Person> people1 = {
        {"Alice", 25}, {"Bob", 20}, {"Charlie", 30}
    };
    
    // 使用自定义比较器
    set<Person, ComparePerson> people2 = {
        {"Alice", 25}, {"Bob", 20}, {"Charlie", 30}
    };
    
    cout << "按年龄排序: ";
    for (const auto& p : people1) {
        cout << p.name << "(" << p.age << ") ";
    }
    cout << endl;
    
    cout << "按姓名排序: ";
    for (const auto& p : people2) {
        cout << p.name << "(" << p.age << ") ";
    }
    cout << endl;
    
    return 0;
}
```

### 7. 集合运算（针对set）

```cpp
#include <set>
#include <iostream>
using namespace std;

int main() {
    set<int> s1 = {1, 2, 3, 4, 5};
    set<int> s2 = {4, 5, 6, 7, 8};
    set<int> result;
    
    // 并集
    set_union(s1.begin(), s1.end(), s2.begin(), s2.end(), 
              inserter(result, result.begin()));
    cout << "并集: ";
    for (int num : result) cout << num << " ";
    cout << endl;
    
    result.clear();
    
    // 交集
    set_intersection(s1.begin(), s1.end(), s2.begin(), s2.end(),
                     inserter(result, result.begin()));
    cout << "交集: ";
    for (int num : result) cout << num << " ";
    cout << endl;
    
    result.clear();
    
    // 差集
    set_difference(s1.begin(), s1.end(), s2.begin(), s2.end(),
                   inserter(result, result.begin()));
    cout << "差集(s1-s2): ";
    for (int num : result) cout << num << " ";
    cout << endl;
    
    return 0;
}
```